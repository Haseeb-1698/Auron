// Custom security policy for Wazuh Indexer to allow certificate access
// This grants specific permissions needed for SSL/TLS operation

grant {
    // Allow reading SSL certificates from /etc/wazuh-indexer/certs/
    permission java.io.FilePermission "/etc/wazuh-indexer/certs/*", "read";
    permission java.io.FilePermission "/etc/wazuh-indexer/certs/-", "read";

    // Allow reading configuration files
    permission java.io.FilePermission "/usr/share/wazuh-indexer/config/*", "read";
    permission java.io.FilePermission "/usr/share/wazuh-indexer/config/-", "read";

    // Allow reading and writing to data directory
    permission java.io.FilePermission "/var/lib/wazuh-indexer/-", "read,write,delete";

    // Allow reading and writing to log directory
    permission java.io.FilePermission "/var/log/wazuh-indexer/-", "read,write,delete";

    // Allow reading from temp directory
    permission java.io.FilePermission "/tmp/-", "read,write,delete";
    permission java.io.FilePermission "/dev/shm/-", "read,write,delete";

    // Allow reading system properties
    permission java.util.PropertyPermission "*", "read,write";

    // Allow network operations
    permission java.net.SocketPermission "*", "connect,accept,listen,resolve";

    // Allow runtime permissions
    permission java.lang.RuntimePermission "*";
    permission java.lang.reflect.ReflectPermission "*";

    // Allow security permissions for SSL/TLS
    permission java.security.SecurityPermission "*";

    // Allow management permissions
    permission javax.management.MBeanServerPermission "*";
    permission javax.management.MBeanPermission "*", "*";
    permission javax.management.MBeanTrustPermission "*";
};
